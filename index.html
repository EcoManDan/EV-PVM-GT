<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PVM Waste Sort Game</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; text-align: center; }
    #content, #introSection, #gameContainer, #finalSection { display: none; }
    /* Grid styles */
    #diversionGrid, #answers { display: grid; gap: 20px; max-width: 800px; margin: 20px auto; }
    #diversionGrid { grid-template-columns: repeat(4,1fr); }
    #answers { grid-template-columns: repeat(4,1fr); justify-items: center; }
    .diversionCard, .answerButton { text-align: center; background: none; border: none; cursor: pointer; }
    .diversionCard img, .answerButton img { width: 100px; height: 100px; object-fit: cover; display: block; margin: 0 auto; }
    .label { margin-top: 5px; font-size: 0.9em; font-weight: bold; }
    #questionImage { width: 400px; height: 300px; object-fit: cover; margin-bottom: 10px; }
    #feedback { margin-top: 10px; font-weight: bold; }
    #score { margin-top: 20px; font-size: 1.2em; }
    #introPreamble { max-width: 800px; margin: 0 auto 20px; text-align: left; }
    #introPreamble ul { margin-left: 20px; }
    table { width: 80%; border-collapse: collapse; margin: 10px auto; }
    th, td { border: 1px solid #333; padding: 8px; text-align: center; }
  </style>
</head>
<body>
  <!-- Language selector -->
  <div id="languageSelection">
    <h2>Select Language / Sélectionnez la langue</h2>
    <button id="langEnglish">English</button>
    <button id="langFrench">Français</button>
  </div>

  <!-- Main container -->
  <div id="content">
    <!-- User Info -->
    <div id="userInfo">
      <h2>Please enter your information:</h2>
      <form id="userInfoForm">
        <label for="firstName">First Name:</label>
        <input type="text" id="firstName" required><br><br>
        <label for="lastName">Last Name:</label>
        <input type="text" id="lastName" required><br><br>
        <label for="email">ECCC Email Address:</label>
        <input type="email" id="email" required><br><br>
        <button type="submit">Continue</button>
      </form>
    </div>

    <!-- Intro to Diversion Options -->
    <div id="introSection">
      <h2>Waste Diversion Options</h2>
      <div id="introPreamble">
        <p>Building-wide compost is finally available at Place Vincent Massey! You now have better options to divert your office waste!</p>
        <p>Why is this important? Because ECCC is committed to:</p>
        <ul>
          <li>Diverting at least 75% of operational and plastic waste from the landfill, and</li>
          <li>Reducing GHG emissions by at least 40% for federal facilities.</li>
        </ul>
        <p>This is totally doable, but we need your help putting waste into the right place!</p>
      </div>
      <div id="diversionGrid"></div>
      <button id="introContinue">Start Quiz</button>
    </div>

    <!-- Quiz -->
    <div id="gameContainer">
      <h2 id="questionCounter"></h2>
      <img id="questionImage" src="" alt="Waste item">
      <h3 id="questionText"></h3>
      <div id="answers"></div>
      <div id="feedback"></div>
      <button id="nextButton" class="hidden">Next</button>
      <div id="score"></div>
    </div>

    <!-- Final -->
    <div id="finalSection">
      <h2>Game Over!</h2>
      <div id="finalScore"></div>
      <div id="thankYouMsg">Thank you for playing!</div>
      <h3>Leaderboard</h3>
      <div id="leaderboard"></div>
      <div id="submissionStatus"></div>
    </div>
  </div>

  <script>
    // Questions array
    const questions = [
      { item: "Yogurt Cup", image: "images/yogurt.jpg", correct: ["Recycle"] },
      { item: "Pizza Box", image: "images/pizza-box.png", correct: ["Compost"] },
      { item: "Milk Carton", image: "images/milk-carton.png", correct: ["Recycle"] },
      { item: "Pop Can", image: "images/pop-can.png", correct: ["Consignaction Box", "Recycle"] },
      { item: "Aluminum Foil", image: "images/aluminum-foil.png", correct: ["Recycle"] },
      { item: "Wine Bottle", image: "images/wine-bottle.png", correct: ["Recycle"] },
      { item: "Newspapers and Flyers", image: "images/newspapers.png", correct: ["Recycle"] },
      { item: "Plastic beverage bottles", image: "images/pop-bottles.jpg", correct: ["Consignaction Box", "Recycle"] },
      { item: "Soup can", image: "images/soup.png", correct: ["Recycle"] },
      { item: "Plastic Wrap, bread bags, ziplocs", image: "images/bags.png", correct: ["Recycle"] },
      { item: "Pens, Highlighters, Sharpies", image: "images/writing-utensils.png", correct: ["Office Supplies Box"] },
      { item: "Juice and Beverage Boxes", image: "images/juice-box.png", correct: ["Recycle"] },
      { item: "Chip bags, granola/candy bar wrappers, gum blister pack", image: "images/snack-wrapper.png", correct: ["Snack Wrapper Box"] },
      { item: "Batteries", image: "images/batteries.png", correct: ["Battery Box"] },
      { item: "Popsicle Sticks", image: "images/popsicle-sticks.png", correct: ["Compost"] },
      { item: "Plastic Coffee Pod", image: "images/plastic-coffee-pod.png", correct: ["Coffee Pod Box"] },
      { item: "Paper Coffee Cup and Lid", image: "images/coffee-cup.png", correct: ["Recycle"] },
      { item: "Plastic utensils", image: "images/plastic-utensils.png", correct: ["Regular Garbage"] },
      { item: "Styrofoam", image: "images/styrofoam.png", correct: ["Regular Garbage"] },
      { item: "Coffee grounds and filters", image: "images/coffee-grounds.png", correct: ["Compost"] },
      { item: "Food leftovers", image: "images/leftovers.png", correct: ["Compost"] },
      { item: "Tea and tea bags", image: "images/teabags.png", correct: ["Compost"] },
      { item: "Paper plates (unwaxed)", image: "images/paper-plates.png", correct: ["Compost"] },
      { item: "Tissue", image: "images/tissue.png", correct: ["Compost"] },
      { item: "Parchment Paper", image: "images/parchment.jpg", correct: ["Compost"] },
      { item: "Disposable water bottle", image: "images/water.png", correct: ["Consignaction Box", "Recycle"] }
    ];
    const options = [
      { key: "Recycle", img: "images/recycle.png" },
      { key: "Compost", img: "images/compost.png" },
      { key: "Coffee Pod Box", img: "images/coffee-pod-box.png" },
      { key: "Snack Wrapper Box", img: "images/snack-wrapper-box.png" },
      { key: "Office Supplies Box", img: "images/office-supplies-box.png" },
      { key: "Consignaction Box", img: "images/consignaction-box.png" },
      { key: "Battery Box", img: "images/battery-box.png" },
      { key: "Regular Garbage", img: "images/garbage.png" }
    ];

    let idx=0, score=0, shuffled;
    // Show language selector
    document.getElementById('languageSelection').style.display='block';
    document.getElementById('langEnglish').onclick=showUser;
    document.getElementById('langFrench').onclick=showUser;
    function showUser(){
      document.getElementById('languageSelection').style.display='none';
      document.getElementById('content').style.display='block';
      document.getElementById('userInfo').style.display='block';
    }
    document.getElementById('userInfoForm').onsubmit=e=>{
      e.preventDefault(); renderGrid();
      document.getElementById('userInfo').style.display='none';
      document.getElementById('introSection').style.display='block';
    };
    function renderGrid(){
      const g=document.getElementById('diversionGrid');g.innerHTML='';
      options.forEach(o=>{
        const c=document.createElement('div');c.className='diversionCard';
        c.innerHTML=`<img src="${o.img}" alt="${o.key}"><div class="label">${o.key}</div>`;
        g.appendChild(c);
      });
    }
    document.getElementById('introContinue').onclick=e=>{
      document.getElementById('introSection').style.display='none';
      document.getElementById('gameContainer').style.display='block';
      startQuiz();
    };
    function startQuiz(){
      shuffled=questions.sort(()=>0.5-Math.random()); idx=0; score=0;
      showQuestion(); updateScore();
    }
    function showQuestion(){
      const q=shuffled[idx];
      document.getElementById('questionCounter').innerText=`Question ${idx+1} of ${shuffled.length}`;
      document.getElementById('questionText').innerText=q.item;
      document.getElementById('questionImage').src=q.image;
      const a=document.getElementById('answers'); a.innerHTML='';
      options.forEach(o=>{
        const b=document.createElement('button');b.className='answerButton';
        b.innerHTML=`<img src="${o.img}" alt="${o.key}"><div class="label">${o.key}</div>`;
        b.onclick=()=>check(o.key);
        a.appendChild(b);
      });
      document.getElementById('feedback').innerText='';
      document.getElementById('nextButton').classList.add('hidden');
    }
    function check(choice){
      const correct=shuffled[idx].correct;
      document.querySelectorAll('#answers button').forEach(b=>b.disabled=true);
      if(correct.includes(choice)){ score++; document.getElementById('feedback').innerText='Correct!'; }
      else{ document.getElementById('feedback').innerText=`Incorrect! Correct: ${correct.join(' or ')}`; }
      updateScore();
      document.getElementById('nextButton').classList.remove('hidden');
      document.getElementById('nextButton').onclick=()=>{
        idx++; if(idx>=shuffled.length) end(); else showQuestion();
      };
    }
    function updateScore(){ document.getElementById('score').innerText=`Score: ${score}`; }
    function end(){
      document.getElementById('gameContainer').style.display='none';
      document.getElementById('finalSection').style.display='block';
      document.getElementById('finalScore').innerText=`Your final score: ${score} of ${shuffled.length}`;
    }
  </script>
</body>
</html>
